mruby-apr
=========

The [Apache Portable Runtime Project](https://apr.apache.org/) is a collection of "software libraries that provide a predictable and consistent interface to underlying platform-specific implementations." `mruby-apr` leverages the work done by the APR developers to provide a cross-platform API for system facilities (like processes) to mruby without having to repeat this work.

`mrb-apr` was created as a component of the [lamina project](https://github.com/jbreeden/lamina). Feature development

Building
--------

To build this gem into your mruby instance, just download the repo and add a couple of lines to your `build_config.rb` file:

```Ruby
MRuby::Build.new('host') do |conf|
  # ... Other configurations...

  # mruby-apr depends on these other mrbgems
  conf.gem :github => 'iij/mruby-io'
  conf.gem :github => 'iij/mruby-errno'

  # Include the mruby-apr gem
  conf.gem "PATH/TO/mruby-apr"

  # Call configure_muby_apr with the `conf` object
  # (This just sets the required compiler options)
  configure_mruby_apr(conf)

end
```

Note: The `configure_mruby_apr` function currently only supports the Windows platform at the moment. If you're on another system, have a quick peak at the `mrbgem.rake` file and replace the body of the `else` clause in the platform check - shown below - with the required setup for your platform (pull requests are welcomed ;).

```
if ENV['OS'] =~ /windows/i
  # ... already implemented ....
else
  raise "No mruby-apr build settings configured for this platform"
end
```

API
---

Look in the `docs/` folder for a full API reference. The rest of this section describes design decisions.

`mruby-apr` defines the APR module along with a set of child modules & classes. All of the functionality of `mruby-apr` can be accessed through this module. In the `APR` module, behavior is permitted to differ from the CRuby standard significantly (opting instead for a more direct APR wrapper). When possible, the routines in APR are wrapped up in a standard Ruby API (for example, by defining methods on the `Kernel` or `Process` modules).

Docs are being generated by a quick-and-dirty markdown extractor dubbed `md-doc.rb` (it's in the repo). I sort of like the bare markdown approach, but if you know a better way to document C & Ruby code for mruby let me know!

APR Version
-----------

Currently building with apr-1.5.1
